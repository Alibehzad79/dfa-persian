<div dir="rtl">

# Web APIs

قبل از اینکه شروع به ساختن وب api خودمان کنیم مهم است که مرور کنیم صفحات وب واقعا چگونه کار می کنند.

 گذشته از همه اینها یک "وب api" به معنای واقعی کلمه در بالای معماری حال حاضر شبکه جهانی وب قرار می گیرد و به مجموعه ای از فناوری ها از جمله HTTP، TCP/IP و غیره متکی است.

در این فصل اصطلاحات اساسی وب API را بررسی خواهیم کرد: <span dir="ltr">endpoints, resources, HTTP
verbs</span>, کدهای وضعیت HTTP و REST. حتی اگر با این موارد از قبل آشنایی دارید توصیه می کنم که این فصل را به طور کامل بخوانید.

### شبکه جهانی وب

اینترنت سیستمی از شبکه های کامپیوتری به هم پیوسته است که حداقل از دهه 1960 وجود داشته است. به هر حال استفاده اولیه از اینترنت محدود به تعداد کمی از شبکه‌های مجزا، عمدتاً دولتی، نظامی یا علمی بود که اطلاعات را به صورت الکترونیکی رد و بدل می‌کردند.

در دهه 1980، بسیاری از مؤسسات تحقیقاتی و دانشگاه ها از اینترنت برای به اشتراک گذاری داده ها استفاده می کردند.

در اروپا، بزرگترین گره(Node) اینترنتی در CERN (سازمان اروپایی تحقیقات هسته ای) در ژنو سوئیس که بزرگترین آزمایشگاه فیزیک ذرات جهان را اداره میکند قرار داشت. این آزمایش‌ها مقادیر عظیمی از داده‌ها را تولید می‌کنند که باید از راه دور با دانشمندان در سراسر جهان به اشتراک گذاشته می شدند.

در مقایسه با امروز، استفاده کلی از اینترنت در دهه 1980 بسیار ناچیز بود.اکثر مردم به آن دسترسی نداشتند یا حتی دلیل اهمیت آن را درک نمی کردند. تعداد کمی از گره‌های اینترنتی تمام ترافیک را تأمین می‌کردند و رایانه‌هایی که از آن استفاده می‌کردند، عمدتاً در همان شبکه‌های کوچک بودند.

همه اینها در سال 1989 زمانی که یک دانشمند محقق در سرن، (Tim Berners-Lee) HTTP را اختراع کرد، تغییر کرد و شبکه جهانی وب مدرن را آغاز کرد. نگرش او این بود که سیستم hypertext12 موجود، که در آن متن نمایش داده شده بر روی صفحه کامپیوتر حاوی پیوند (هایپرلینک) به اسناد دیگر است، می تواند به اینترنت منتقل شود.

اختراع او، پروتکل انتقال هایپرتکست (HTTP)13، اولین راه استاندارد و جهانی برای به اشتراک گذاری اسناد از طریق اینترنت بود. این پروتکل در قالب صفحات وب ارائه می دهد: اسناد گسسته با URL پیوندها و منابعی مثل عکس ها صوت و ویدیو.

امروزه، زمانی که بیشتر مردم به «اینترنت» فکر می‌کنند، در واقع به شبکه جهانی وب فکر می‌کنند، که در حال حاضر راه اصلی برقراری ارتباط آنلاین میلیاردها نفر و رایانه است.

### URLs

یک url (تعیین کننده محل منابع) آدرس یک منبع بر روی شبکه اینترنت می باشد. برای مثال صفحه اصلی گوگل در https://www.google.com می باشد.

وقتی که می خواهید به صفحه اصلی گوگل بروید شما url کامل آن را در مرورگر تایپ می کنید. 
مرورگر شما از طریق اینترنت یک درخواست می فرستد و یک سرور که به درخواست شما با داده های مورد نیاز برای نمایش صفحه اصلی Google در مرورگر شما پاسخ می دهد(به زودی آنچه واقعا اتفاق می افتد را پوشش خواهیم داد).

این الگوی درخواست و پاسخ اساس همه ارتباطات وب است. یک کلاینت (معمولاً یک مرورگر اما می تواند یک برنامه یا هر دستگاه متصل به اینترنت باشد) اطلاعاتی را درخواست می کند و سرور پاسخ می دهد.

از آنجایی که ارتباطات وب از طریق HTTP انجام می شود، اینها بیشتر به عنوان درخواست های HTTP و پاسخ های HTTP شناخته می شوند.

در یک URL داده شده نیز چندین مؤلفه مجزا وجود دارد. برای مثال صفحه اصلی گوگل را که در https://www.google.com واقع شده است در نظر بگیرید. قسمت اول یا همان https به نوع درخواست استفاده شده اشاره دارد.

این بخش به مرورگر وب می گوید که چگونه به منابع موجود در أدرس دسترسی داشته باشد.

برای یک وب‌سایت، این معمولاً http یا https است، اما همچنین می‌تواند برای فایل‌ها ftp، برای ایمیل smtp و غیره باشد. 
بخش بعدی، www.google.com، نام میزبان یا نام واقعی سایت است. هر url شامل هر URL حاوی یک نوع درخواست و یک میزبان(هاست) است.

بسیاری از صفحات وب همچنین شامل یک مسیر اختیاری هستند. اگر به صفحه اصلی پایتون در https://www.python.org بروید و روی پیوند صفحه «about» کلیک کنید، به https://www.python.org/about/ هدایت خواهید شد. /about/ یک بخش از آدرس صفحه است.

به طور خلاصه، هر URL مانند https://python.org/about/ دارای سه بخش نهانی است:


- یک طرح(نوع درخواست) - https
- نام میزبان - www.python.org
- و یک مسیر (اختیاری) - /about/

### مجموعه پروتکل اینترنت

هنگامی که URL واقعی یک منبع را می دانیم، مجموعه کاملی از فناوری های دیگر باید به درستی (با هم) کار کنند تا کلاینت را به سرور متصل کرده و یک صفحه وب واقعی را بارگیری کند. این به طور گسترده به عنوان مجموعه پروتکل اینترنت  نامیده می شود و کتاب های کاملی وجود دارد که فقط برای این موضوع نوشته شده است. با این حال، برای اهداف خود، می‌توانیم به اصول کلی پایبند باشیم.

هنگامی که کاربر https://www.google.com را در مرورگر وب خود تایپ می کند و دکمه اینتر را می زند، چندین اتفاق می افتد.ابتدا مرورگر باید سرور مورد نظر را در جایی در اینترنت گسترده پیدا کند.
از یک سرویس نام دامنه (DNS) برای ترجمه نام دامنه "google.com" به آدرس IP استفاده می کند، که یک دنباله منحصر به فرد از اعداد است که هر دستگاه متصل را نشان می دهد.
اینترنت از نام های دامنه استفاده می کند زیرا به خاطر سپردن نام دامنه برای انسان آسان تر است
مانند «google.com» تا یک آدرس IP مانند «172.217.164.68».

پس از اینکه مرورگر آدرس IP یک دامنه معین را داشت، به راهی برای ایجاد یک ارتباط ثابت با سرور مورد نظر نیاز دارد.این از طریق پروتکل کنترل انتقال (TCP) اتفاق می افتد.
که مطمئن، مرتب شده و عاری از خطا انتقال بایت ها را بین دو برنامه ارائه می دهد.

برای ایجاد یک اتصال TCP بین دو کامپیوتر، یک "handshake" سه مسیره بین کلاینت و سرور رخ می دهد:

- کلاینت یک SYN می فرستد و درخواست برقراری اتصال می کند
- سرور با تایید درخواست و ارسال یک پارامتر اتصال با یک SYN-ACK پاسخ می دهد
- کلاینت یک ACK را برای تایید اتصال به سرور ارسال می کند

هنگامی که اتصال TCP برقرار شد، دو کامپیوتر می توانند از طریق HTTP ارتباط برقرار کنند.

### HTTP Verbs

هر صفحه وب شامل یک آدرس (URL) و همچنین لیستی از اقدامات تایید شده به نام HTTP verbs است. تاکنون عمدتاً در مورد دریافت یک صفحه وب صحبت کرده ایم، اما امکان ایجاد، ویرایش و حذف محتوا نیز وجود دارد.

وبسایت فیسبوک را درنظر بگیرید.

بعد از لاگین شما می توانید پست های تایملاینتان را بخوانید یک پست جدید ایجاد کنید یا پست های موجودتان را ویرایش یا حذف کنید. این چهار عمل (خواندن - ساختن - ویرایش کردن - حذف کردن) به صورت عامیانه به عنوان اعمال CRUD شناخته می شوند و اکثر کارهایی که به صورت آنلاین انجام می شود را نمایش می دهد.

پروتکل HTTP حاوی تعدادی روش درخواست است که می توان از آنها در هنگام درخواست اطلاعات از یک سرور استفاده کرد. چهار عمل رایج برای عملکرد CRUD. چهار عمل POST، GET، PUT و DELETE هستند.

<div dir="ltr">

```
CRUD                            HTTP Verbs
----
Create  <-------------------->  POST
Read    <-------------------->  GET
Update  <-------------------->  PUT
Delete  <-------------------->  DELETE
```

</div>

برای ایجاد محتوا از POST، برای خواندن محتوا از GET، برای به روز رسانی آن PUT و برای حذف آن از DELETE استفاده می کنند.

### Endpoints

یک وب سایت از صفحات وب با HTML، CSS، تصاویر، جاوا اسکریپت و موارد دیگر تشکیل شده است. اما یک وب API به جای آن اندپوینت دارد که urlهایی  با فهرستی از اعمال موجود (HTTP VERBS) هستند که داده‌ها را نشان می‌دهند (معمولاً در JSON که رایج‌ترین قالب داده این روزها و پیش‌فرض برای django-rest-framework است).

برای مثال، می‌توانیم اندپوینت API زیر را برای یک وب‌سایت جدید به نام mysite

<div dir="ltr">

```
https://www.mysite.com/api/users      # GET returns all users
https://www.mysite.com/api/users/<id> # GET returns a single user
```

</div>

در اولین اندپوینت /api/users، یک درخواست GET  لیستی از تمام کاربران موجود را برمی گرداند. این نوع اندپوینت که چندین دیتا را برمی گرداند به عنوان یک مجموعه (کالکشن) شناخته می شود.

اندپوینت دوم /api/users/id یک کاربر واحد را نشان می دهد. یک درخواست GET اطلاعات مربوط به یک کاربر را برمی گرداند.

اگر متود POST را به اندپوینت اول اضافه کنیم، می‌توانیم یک کاربر جدید ایجاد کنیم، در حالی که افزودن متود DELETE به اندپوینت دوم به ما امکان حذف یک کاربر را می‌دهد.

در طول این کتاب با اندپوینت های API بیشتر آشنا خواهیم شد، اما در نهایت ایجاد یک API مستلزم ساخت یک سری اندپوینت است: URL هایی با HTTP verbs مرتبط.

یک صفحه وب از HTML، CSS، تصاویر و موارد دیگر تشکیل شده است. اما اندپوینت تنها راهی برای دسترسی به داده ها از طریق  HTTP verbs موجود است.

### HTTP